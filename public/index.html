<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle de Notas Fiscais</title>
    <link rel="stylesheet" href="style.css">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- SheetJS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>

<!-- =======================
     CAIXA DE LOGIN
     ======================= -->
<div id="loginBox" class="box">
    
    <div id="loginForm">
        <h2>Login</h2>
        <input id="loginUser" placeholder="UsuÃ¡rio">
        <input id="loginPass" type="password" placeholder="Senha">
        <button id="btnLogin">Entrar</button>
        <p class="toggle-link">
            NÃ£o tem uma conta? <a href="#" id="showRegister">Registre-se</a>
        </p>
    </div>

    <div id="registerForm" class="hidden">
        <h2>Registrar</h2>
        <input id="regUser" placeholder="Novo usuÃ¡rio">
        <input id="regPass" type="password" placeholder="Nova senha">
        <button id="btnRegister">Registrar</button>
        <p class="toggle-link">
            JÃ¡ tem uma conta? <a href="#" id="showLogin">FaÃ§a login</a>
        </p>
    </div>

    <p class="footer-credit">Desenvolvido por 3Âº Sgt Alex Moreira</p>
</div>
<!-- Fim da Caixa de Login -->


<!-- =======================
     APLICAÃ‡ÃƒO PRINCIPAL
     ======================= -->
<div id="app" class="hidden">

    <header>
        <h2>Controle de Notas Fiscais</h2>
        <button id="logout">Sair</button>
    </header>

    <main class="container">

        <!-- SeÃ§Ã£o do FormulÃ¡rio -->
        <section class="box form-box">
            <h3>Adicionar / Editar Nota</h3>
            
            <div class="form-grid">
                <input type="date" id="data">
                <input type="text" id="empresa" placeholder="Empresa">
                <input type="text" id="numero" placeholder="NÃºmero NF">
                <input type="number" id="valor" placeholder="Valor" step="0.01">
                <input type="text" id="obs" placeholder="ObservaÃ§Ãµes (Opcional)">
                <button id="addNota">Adicionar</button>
                <button id="cancelEdit" class="hidden" style="background-color: #6c757d;">Cancelar EdiÃ§Ã£o</button>
            </div>
            
        </section>
        <!-- Fim da SeÃ§Ã£o do FormulÃ¡rio -->


        <!-- SeÃ§Ã£o da Tabela -->
        <section class="box table-box">
            <h3>Notas LanÃ§adas</h3>

            <input type="text" id="caixaBusca" placeholder="ðŸ”Ž Buscar por empresa, nÃºmero ou observaÃ§Ã£o...">
            
            <div class="table-container">
                <table id="tabelaNotas">
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Empresa</th>
                            <th>NÂº Nota</th>
                            <th>Valor (R$)</th>
                            <th>ObservaÃ§Ãµes</th>
                            <th>AÃ§Ãµes</th>
                        </tr>
                    </thead>
                    <!-- O Tbody serÃ¡ preenchido pelo app.js -->
                    <tbody></tbody>
                </table>
            </div>
        </section>
        <!-- Fim da SeÃ§Ã£o da Tabela -->

        <!-- SeÃ§Ã£o de Resumo -->
<section class="box resumo-box">
    <h3>Resumo</h3>
    
    <!-- ===== NOVOS CAMPOS DE FILTRO ===== -->
    <div class="filtro-mes-container">
        <label for="filtroMes">Filtrar por MÃªs:</label>
        <input type="month" id="filtroMes">
        <button id="resetarFiltro" title="Limpar filtro">âœ–</button>
    </div>
    <!-- =================================== -->

    <!-- ===== O GRID DO RESUMO (APENAS UMA VEZ) ===== -->
    <div class="resumo-grid">
        <p><strong>Total de notas:</strong> <span id="resTotalNotas">0</span></p>
        <p><strong>Valor total:</strong> R$ <span id="resTotalValor">0,00</span></p>
        <p><strong>MÃ©dia por dia:</strong> <span id="resMediaDia">0</span> notas/dia</p>
        <p><strong>MÃ©dia por mÃªs:</strong> <span id="resMediaMes">0</span> notas/mÃªs</p>
    </div>
</section>
<!-- Fim da SeÃ§Ã£o de Resumo -->
        
        <!-- SeÃ§Ã£o do GrÃ¡fico -->
        <section class="box chart-box">
           <h3>Total por MÃªs (R$)</h3>
           <canvas id="grafico"></canvas>
        </section>

    </main>

    <footer>
        <button id="exportExcel">Exportar para Excel (.xlsx)</button>
        <p class="footer-credit">Desenvolvido por 3Âº Sgt Alex Moreira</p>
    </footer>

</div>

<!-- O script Ã© a ÃšLTIMA coisa a ser carregada -->
<script src="app.js"></script>
</body>
</html>

